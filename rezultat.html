<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rezultat Verificare Credit - CreditCheck</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      color: #f3f6fb;
      overflow-x: hidden;
      position: relative;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      padding-top: 100px;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: url("aidan-bartos-v9rZ3Yz6fSg-unsplash.jpg") center/cover no-repeat;
      z-index: -2;
      filter: brightness(0.9);
    }

    body::after {
      content: "";
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.35);
      z-index: -1;
    }

    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 60px;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 1000;
    }

    .logo {
      font-size: 1.8rem;
      font-weight: 700;
      color: #00c6ff;
    }

    .logo .sub {
      font-weight: 400;
      color: #b3c6d6;
      font-size: 1rem;
    }

    #language-switch select {
      background: rgba(0, 198, 255, 0.2);
      border: 1px solid #00c6ff;
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.95rem;
      transition: 0.3s;
      outline: none;
    }

    #language-switch select:hover {
      background: rgba(0, 198, 255, 0.3);
    }

    #language-switch select option {
      background: #1a1a2e;
      color: white;
      padding: 8px;
    }

    .container {
      max-width: 1000px;
      width: 100%;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 20px;
      padding: 40px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }

    .risk-indicator {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 30px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    .risk-level {
      font-size: 2.5rem;
      font-weight: 700;
      margin: 20px 0;
    }

    .risk-low { color: #10b981; }
    .risk-medium-low { color: #3b82f6; }
    .risk-medium { color: #f59e0b; }
    .risk-high { color: #ef4444; }
    .risk-very-high { color: #dc2626; }

    .probability {
      font-size: 3rem;
      font-weight: 700;
      color: #00c6ff;
      margin: 10px 0;
    }

    .recommendation {
      background: linear-gradient(135deg, rgba(0, 198, 255, 0.2) 0%, rgba(0, 114, 255, 0.2) 100%);
      border-left: 4px solid #00c6ff;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      font-size: 1.1rem;
    }

    .details-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .detail-card {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
    }

    .detail-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 198, 255, 0.2);
      border-color: #00c6ff;
      background: rgba(255, 255, 255, 0.15);
    }

    .detail-label {
      color: #94a3b8;
      font-size: 0.85rem;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .detail-value {
      font-size: 1.3rem;
      font-weight: 600;
      color: #f3f6fb;
    }

    .model-card {
      background: linear-gradient(135deg, rgba(0, 198, 255, 0.1) 0%, rgba(0, 114, 255, 0.1) 100%);
      padding: 20px;
      border-radius: 12px;
      border: 1px solid rgba(0, 198, 255, 0.3);
    }

    .model-name {
      color: #00c6ff;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .model-probability {
      font-size: 2rem;
      font-weight: 700;
      color: #f3f6fb;
    }

    .section-title {
      font-size: 1.4rem;
      color: #00c6ff;
      margin: 30px 0 20px 0;
      padding-bottom: 10px;
      border-bottom: 2px solid rgba(0, 198, 255, 0.3);
    }

    .button-group {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 40px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn-primary {
      background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0, 198, 255, 0.4);
    }

    .btn-secondary {
      background: transparent;
      color: #00c6ff;
      border: 2px solid #00c6ff;
    }

    .btn-secondary:hover {
      background: rgba(0, 198, 255, 0.1);
    }

    .info-badge {
      display: inline-block;
      padding: 5px 12px;
      border-radius: 15px;
      font-size: 0.85rem;
      font-weight: 600;
      background: rgba(0, 198, 255, 0.2);
      color: #00c6ff;
      border: 1px solid rgba(0, 198, 255, 0.4);
    }

    .meta-info {
      text-align: center;
      color: #94a3b8;
      font-size: 0.9rem;
      margin-top: 10px;
    }

    @media (max-width: 768px) {
      .navbar {
        padding: 15px 20px;
        flex-wrap: wrap;
        gap: 10px;
      }

      .container {
        padding: 25px;
      }

      .probability {
        font-size: 2.5rem;
      }

      .risk-level {
        font-size: 2rem;
      }

      .details-grid {
        grid-template-columns: 1fr;
      }

      .button-group {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }

    @media print {
      .button-group, .navbar {
        display: none;
      }
      
      body {
        background: white;
        color: black;
      }
      
      .container {
        box-shadow: none;
        border: 1px solid #ccc;
      }
    }
  </style>
</head>
<body>
  <header class="navbar">
    <div class="logo">CreditCheck<span class="sub"> Admin</span></div>
    <div style="color: #94a3b8; font-size: 0.95rem;" id="page-subtitle">
      Rezultat Verificare Credit
    </div>
    <div id="language-switch">
      <select id="language-selector" onchange="setLanguage(this.value)">
        <option value="ro">RO</option>
        <option value="en">EN</option>
        <option value="ru">RU</option>
      </select>
    </div>
  </header>

  <div class="container">
    <div class="risk-indicator">
      <div style="color: #94a3b8; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;" id="npl-label">
        Probabilitate NPL (Non-Performing Loan)
      </div>
      <div class="probability" id="npl-probability">---%</div>
      <div class="risk-level" id="risk-level">---</div>
      <div class="meta-info">
        <div style="margin-top: 15px;">
          <span id="prediction-label">Predicție Clasă:</span> <span id="predictie-clasa" class="info-badge">---</span>
        </div>
      </div>
    </div>

    <div class="section-title" id="models-title">Predicții Modele Individuale (Ensemble)</div>
    <div class="details-grid" id="models-grid">
    </div>

    <div class="section-title" id="credit-details-title">Detalii Credit</div>
    <div class="details-grid">
      <div class="detail-card">
        <div class="detail-label" id="label-loan-amount">Suma Credit (MDL)</div>
        <div class="detail-value" id="loan-amount">---</div>
      </div>
      <div class="detail-card">
        <div class="detail-label" id="label-monthly-income">Venit Lunar (MDL)</div>
        <div class="detail-value" id="monthly-income">---</div>
      </div>
      <div class="detail-card">
        <div class="detail-label" id="label-credit-score">Scor Credit</div>
        <div class="detail-value" id="credit-score">---</div>
      </div>
      <div class="detail-card">
        <div class="detail-label" id="label-tenor">Perioadă (luni)</div>
        <div class="detail-value" id="tenor">---</div>
      </div>
    </div>

    <div class="section-title" id="financial-indicators-title">Indicatori Financiari</div>
    <div class="details-grid">
      <div class="detail-card">
        <div class="detail-label" id="label-dti">DTI (Debt-to-Income)</div>
        <div class="detail-value" id="dti">---</div>
      </div>
      <div class="detail-card">
        <div class="detail-label" id="label-pti">PTI (Payment-to-Income)</div>
        <div class="detail-value" id="pti">---</div>
      </div>
      <div class="detail-card">
        <div class="detail-label" id="label-ltv">LTV (Loan-to-Value)</div>
        <div class="detail-value" id="ltv">---</div>
      </div>
      <div class="detail-card">
        <div class="detail-label" id="label-interest-rate">Dobândă Anuală</div>
        <div class="detail-value" id="interest-rate">---</div>
      </div>
    </div>

    <div class="section-title" id="client-info-title">Informații Client</div>
    <div class="details-grid">
      <div class="detail-card">
        <div class="detail-label" id="label-segment">Segment</div>
        <div class="detail-value" id="segment">---</div>
      </div>
      <div class="detail-card">
        <div class="detail-label" id="label-region">Regiune</div>
        <div class="detail-value" id="region">---</div>
      </div>
      <div class="detail-card">
        <div class="detail-label" id="label-loan-type">Tip Credit</div>
        <div class="detail-value" id="loan-type">---</div>
      </div>
      <div class="detail-card">
        <div class="detail-label" id="label-currency">Monedă</div>
        <div class="detail-value" id="currency">---</div>
      </div>
    </div>

    <div class="button-group">
      <a href="index.html" class="btn btn-secondary" id="btn-back">Înapoi la Formular</a>
      <button onclick="window.print()" class="btn btn-primary" id="btn-print">Printează Raport</button>
    </div>
  </div>

  <script>
    const translations = {
      ro: {
        pageSubtitle: 'Rezultat Verificare Credit',
        nplLabel: 'Probabilitate NPL (Non-Performing Loan)',
        predictionLabel: 'Predicție Clasă:',
        npl: 'NPL',
        nonNpl: 'Non-NPL',
        modelsTitle: 'Predicții Modele Individuale (Ensemble)',
        creditDetailsTitle: 'Detalii Credit',
        financialIndicatorsTitle: 'Indicatori Financiari',
        clientInfoTitle: 'Informații Client',
        labelLoanAmount: 'Suma Credit (MDL)',
        labelMonthlyIncome: 'Venit Lunar (MDL)',
        labelCreditScore: 'Scor Credit',
        labelTenor: 'Perioadă (luni)',
        labelDti: 'DTI (Debt-to-Income)',
        labelPti: 'PTI (Payment-to-Income)',
        labelLtv: 'LTV (Loan-to-Value)',
        labelInterestRate: 'Dobândă Anuală',
        labelSegment: 'Segment',
        labelRegion: 'Regiune',
        labelLoanType: 'Tip Credit',
        labelCurrency: 'Monedă',
        btnBack: 'Înapoi la Formular',
        btnPrint: 'Printează Raport',
        months: 'luni',
        riskLow: 'Scăzut',
        riskMediumLow: 'Mediu-Scăzut',
        riskMedium: 'Mediu',
        riskHigh: 'Ridicat',
        riskVeryHigh: 'Foarte Ridicat',
        noDataError: 'Nu există date disponibile. Vă rugăm să completați formularul mai întâi.',
        processingError: 'Eroare la procesarea datelor. Vă rugăm să încercați din nou.'
      },
      en: {
        pageSubtitle: 'Credit Verification Result',
        nplLabel: 'NPL Probability (Non-Performing Loan)',
        predictionLabel: 'Class Prediction:',
        npl: 'NPL',
        nonNpl: 'Non-NPL',
        modelsTitle: 'Individual Model Predictions (Ensemble)',
        creditDetailsTitle: 'Credit Details',
        financialIndicatorsTitle: 'Financial Indicators',
        clientInfoTitle: 'Client Information',
        labelLoanAmount: 'Loan Amount (MDL)',
        labelMonthlyIncome: 'Monthly Income (MDL)',
        labelCreditScore: 'Credit Score',
        labelTenor: 'Period (months)',
        labelDti: 'DTI (Debt-to-Income)',
        labelPti: 'PTI (Payment-to-Income)',
        labelLtv: 'LTV (Loan-to-Value)',
        labelInterestRate: 'Annual Interest',
        labelSegment: 'Segment',
        labelRegion: 'Region',
        labelLoanType: 'Loan Type',
        labelCurrency: 'Currency',
        btnBack: 'Back to Form',
        btnPrint: 'Print Report',
        months: 'months',
        riskLow: 'Low',
        riskMediumLow: 'Medium-Low',
        riskMedium: 'Medium',
        riskHigh: 'High',
        riskVeryHigh: 'Very High',
        noDataError: 'No data available. Please complete the form first.',
        processingError: 'Error processing data. Please try again.'
      },
      ru: {
        pageSubtitle: 'Результат Проверки Кредита',
        nplLabel: 'Вероятность NPL (Неработающий Кредит)',
        predictionLabel: 'Предсказание Класса:',
        npl: 'NPL',
        nonNpl: 'Не-NPL',
        modelsTitle: 'Предсказания Отдельных Моделей (Ансамбль)',
        creditDetailsTitle: 'Детали Кредита',
        financialIndicatorsTitle: 'Финансовые Показатели',
        clientInfoTitle: 'Информация о Клиенте',
        labelLoanAmount: 'Сумма Кредита (MDL)',
        labelMonthlyIncome: 'Месячный Доход (MDL)',
        labelCreditScore: 'Кредитный Рейтинг',
        labelTenor: 'Период (месяцы)',
        labelDti: 'DTI (Долг к Доходу)',
        labelPti: 'PTI (Платеж к Доходу)',
        labelLtv: 'LTV (Кредит к Стоимости)',
        labelInterestRate: 'Годовая Процентная Ставка',
        labelSegment: 'Сегмент',
        labelRegion: 'Регион',
        labelLoanType: 'Тип Кредита',
        labelCurrency: 'Валюта',
        btnBack: 'Назад к Форме',
        btnPrint: 'Печать Отчета',
        months: 'месяцев',
        riskLow: 'Низкий',
        riskMediumLow: 'Средне-Низкий',
        riskMedium: 'Средний',
        riskHigh: 'Высокий',
        riskVeryHigh: 'Очень Высокий',
        noDataError: 'Нет доступных данных. Пожалуйста, заполните форму сначала.',
        processingError: 'Ошибка при обработке данных. Пожалуйста, попробуйте снова.'
      }
    };

    let currentLang = 'ro';

    function setLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('creditCheckLanguage', lang);
      
      const t = translations[lang];
      document.documentElement.lang = lang;
      
      document.getElementById('page-subtitle').textContent = t.pageSubtitle;
      document.getElementById('npl-label').textContent = t.nplLabel;
      document.getElementById('prediction-label').textContent = t.predictionLabel;
      document.getElementById('models-title').textContent = t.modelsTitle;
      document.getElementById('credit-details-title').textContent = t.creditDetailsTitle;
      document.getElementById('financial-indicators-title').textContent = t.financialIndicatorsTitle;
      document.getElementById('client-info-title').textContent = t.clientInfoTitle;
      
      document.getElementById('label-loan-amount').textContent = t.labelLoanAmount;
      document.getElementById('label-monthly-income').textContent = t.labelMonthlyIncome;
      document.getElementById('label-credit-score').textContent = t.labelCreditScore;
      document.getElementById('label-tenor').textContent = t.labelTenor;
      document.getElementById('label-dti').textContent = t.labelDti;
      document.getElementById('label-pti').textContent = t.labelPti;
      document.getElementById('label-ltv').textContent = t.labelLtv;
      document.getElementById('label-interest-rate').textContent = t.labelInterestRate;
      document.getElementById('label-segment').textContent = t.labelSegment;
      document.getElementById('label-region').textContent = t.labelRegion;
      document.getElementById('label-loan-type').textContent = t.labelLoanType;
      document.getElementById('label-currency').textContent = t.labelCurrency;
      
      document.getElementById('btn-back').textContent = t.btnBack;
      document.getElementById('btn-print').textContent = t.btnPrint;
      
      document.getElementById('language-selector').value = lang;
      
      updateRiskLevelTranslation();
    }

    function updateRiskLevelTranslation() {
      const riskLevelEl = document.getElementById('risk-level');
      if (riskLevelEl && riskLevelEl.dataset.originalRisk) {
        const t = translations[currentLang];
        const riskMap = {
          'Scăzut': t.riskLow,
          'Mediu-Scăzut': t.riskMediumLow,
          'Mediu': t.riskMedium,
          'Ridicat': t.riskHigh,
          'Foarte Ridicat': t.riskVeryHigh,
          'Low': t.riskLow,
          'Medium-Low': t.riskMediumLow,
          'Medium': t.riskMedium,
          'High': t.riskHigh,
          'Very High': t.riskVeryHigh,
          'Низкий': t.riskLow,
          'Средне-Низкий': t.riskMediumLow,
          'Средний': t.riskMedium,
          'Высокий': t.riskHigh,
          'Очень Высокий': t.riskVeryHigh
        };
        riskLevelEl.textContent = riskMap[riskLevelEl.dataset.originalRisk] || riskLevelEl.dataset.originalRisk;
      }
      
      const predictieClasaEl = document.getElementById('predictie-clasa');
      if (predictieClasaEl && predictieClasaEl.dataset.originalClass) {
        const t = translations[currentLang];
        predictieClasaEl.textContent = predictieClasaEl.dataset.originalClass === '1' ? t.npl : t.nonNpl;
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
      const savedLang = localStorage.getItem('creditCheckLanguage') || 'ro';
      setLanguage(savedLang);

      const resultData = localStorage.getItem('creditCheckResult');
      const requestData = localStorage.getItem('creditCheckRequest');

      if (!resultData || !requestData) {
        const t = translations[currentLang];
        alert(t.noDataError);
        window.location.href = 'index.html';
        return;
      }

      try {
        const result = JSON.parse(resultData);
        const request = JSON.parse(requestData);

        console.log('Result:', result);
        console.log('Request:', request);

        const nplProb = (result.probabilitate_npl * 100).toFixed(2);
        document.getElementById('npl-probability').textContent = nplProb + '%';

        const riskLevelEl = document.getElementById('risk-level');
        const riskLevel = result.categorie_risc;
        riskLevelEl.dataset.originalRisk = riskLevel;
        
        const riskClassMap = {
          'Scăzut': 'risk-low',
          'Mediu-Scăzut': 'risk-medium-low',
          'Mediu': 'risk-medium',
          'Ridicat': 'risk-high',
          'Foarte Ridicat': 'risk-very-high'
        };
        
        riskLevelEl.className = 'risk-level ' + (riskClassMap[riskLevel] || 'risk-medium');

        const predictieClasaEl = document.getElementById('predictie-clasa');
        predictieClasaEl.dataset.originalClass = result.predictie_clasa.toString();
        
        updateRiskLevelTranslation();

        const modelsGrid = document.getElementById('models-grid');
        modelsGrid.innerHTML = '';
        
        if (result.predictii_individuale) {
          Object.entries(result.predictii_individuale).forEach(([modelName, probability]) => {
            const modelCard = document.createElement('div');
            modelCard.className = 'model-card';
            
            const probPercent = (probability * 100).toFixed(2);
            
            modelCard.innerHTML = `
              <div class="model-name">${modelName}</div>
              <div class="model-probability">${probPercent}%</div>
            `;
            
            modelsGrid.appendChild(modelCard);
          });
        }

        const t = translations[currentLang];
        
        document.getElementById('loan-amount').textContent = formatNumber(request.loan_amount_mdl) + ' MDL';
        document.getElementById('monthly-income').textContent = formatNumber(request.monthly_income_mdl) + ' MDL';
        document.getElementById('credit-score').textContent = request.credit_bureau_score;
        document.getElementById('tenor').textContent = request.tenor_months + ' ' + t.months;

        document.getElementById('dti').textContent = (request.dti * 100).toFixed(2) + '%';
        document.getElementById('pti').textContent = (request.pti * 100).toFixed(2) + '%';
        document.getElementById('ltv').textContent = (request.ltv * 100).toFixed(2) + '%';
        document.getElementById('interest-rate').textContent = request.interest_rate_annual.toFixed(2) + '%';

        document.getElementById('segment').textContent = request.segment;
        document.getElementById('region').textContent = request.region;
        document.getElementById('loan-type').textContent = request.loan_type;
        document.getElementById('currency').textContent = request.currency;

      } catch (error) {
        console.error('Eroare la procesarea datelor:', error);
        const t = translations[currentLang];
        alert(t.processingError);
        window.location.href = 'index.html';
      }
    });

    function formatNumber(num) {
      return new Intl.NumberFormat('ro-RO', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      }).format(num);
    }
  </script>
</body>
</html>